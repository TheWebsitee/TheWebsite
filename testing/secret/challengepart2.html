<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page</title>
    <link rel="stylesheet" href="https://thewebsitee.github.io/TheWebsite/css/main.css">
    <link rel="stylesheet" href="https://thewebsitee.github.io/TheWebsite/css/changelog.css">
</head>
<body>
    <h1>Challenge part 2! Congrats!</h1>
    <p>This many people fell for it <span id="visit-count">...</span> times.</p>
    <p>crazy I literally just said this wasn't going to work.</p>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-analytics.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCPQ-VEkUIU7a4OOpK8yeS2GhAmR8wiK1M",
            authDomain: "thewebsite-d7a18.firebaseapp.com",
            projectId: "thewebsite-d7a18",
            storageBucket: "thewebsite-d7a18.appspot.com",
            messagingSenderId: "157727332699",
            appId: "1:157727332699:web:44008cbc8428196c7c627e",
            measurementId: "G-1TCEBXE7RB"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
        async function updateVisitCount() {
            const visitRef = doc(db, 'counters', 'dummyVisits');
            try {
                const docSnap = await getDoc(visitRef);

                if (docSnap.exists()) {
                    let visitCount = docSnap.data().count;
                    console.log("Current visit count:", visitCount);


                    visitCount++;
                    document.getElementById('visit-count').textContent = visitCount;

                    await setDoc(visitRef, { count: visitCount });
                    console.log("Visit count updated successfully");
                    console.log("bruh how many times do I have to tell you this aint gonna work. In order to progress you'll have to move to the new website where you can't see the source code as easy :) but of course I hid the link as a comment on one of the many pages on this site have fun!");
                } else {

                    console.log("No document found, creating new document...");
                    await setDoc(visitRef, { count: 1 });
                    document.getElementById('visit-count').textContent = 1;
                }
            } catch (error) {
                console.error("Error getting or updating document:", error);
            }
        }


        updateVisitCount();

        
    </script>
</body>
</html>
