<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page</title>
    <!-- Load Firebase SDKs -->
    <!-- Firebase App (Core SDK) -->
    <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js"></script>
    <!-- Firebase Firestore SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js"></script>
</head>
<body>
    <h1>Global Page Visit Counter</h1>
    <p>This page has been visited <span id="visit-count">...</span> times.</p>

    <script>
        // Your Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyCPQ-VEkUIU7a4OOpK8yeS2GhAmR8wiK1M",
          authDomain: "thewebsite-d7a18.firebaseapp.com",
          projectId: "thewebsite-d7a18",
          storageBucket: "thewebsite-d7a18.appspot.com",
          messagingSenderId: "157727332699",
          appId: "1:157727332699:web:44008cbc8428196c7c627e",
          measurementId: "G-1TCEBXE7RB"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Reference to the 'pageVisits' document in Firestore
        const visitRef = db.collection('counters').doc('pageVisits');

        // Fetch the current count and update the visit count
        visitRef.get().then((doc) => {
            if (doc.exists) {
                let visitCount = doc.data().count;
                console.log("Document data:", doc.data()); // Debugging - log the document data

                // Increment the count
                visitCount++;
                document.getElementById('visit-count').textContent = visitCount;

                // Update the count in Firestore
                visitRef.set({ count: visitCount }).then(() => {
                    console.log("Visit count updated successfully");
                }).catch((error) => {
                    console.error("Error updating Firestore:", error); // Error handling for update
                });
            } else {
                // If the document doesn't exist, create it with an initial count of 1
                console.log("No document found, creating new document...");
                visitRef.set({ count: 1 }).then(() => {
                    document.getElementById('visit-count').textContent = 1;
                    console.log("New document created with count 1");
                }).catch((error) => {
                    console.error("Error creating document:", error); // Error handling for creation
                });
            }
        }).catch((error) => {
            console.error("Error fetching document:", error); // Error handling for fetching document
        });
    </script>
</body>
</html>
